<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>bpcs - A package for Bayesian Paired Comparison analysis with Stan • bpcs</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="bpcs - A package for Bayesian Paired Comparison analysis with Stan">
<meta property="og:description" content="The bpcs package provides pre compiled Stan models for the analysis of paired comparison data. The models include Bayesian versions of the Bradley-Terry model, including random effects (1 level), generalized model for predictors, order effect (home advantage) and the same variations for the Davidson (1970) model to handle ties. Additionally, we provide a number of functions to facilitate inference and obtaining results with these models.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">bpcs</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/a_get_started.html">Getting Started with the bpcs package</a>
    </li>
    <li>
      <a href="articles/b_ties_and_home_advantage.html">Home advantage in the Bradley-Terry and in the Davidson model</a>
    </li>
    <li>
      <a href="articles/c_bt_random_effects.html">Random effects in the Bradley-Terry model</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/davidissamattos/bpcs/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<div id="bpcs---a-package-for-bayesian-paired-comparison-analysis-with-stan-" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#bpcs---a-package-for-bayesian-paired-comparison-analysis-with-stan-" class="anchor"></a>bpcs - A package for Bayesian Paired Comparison analysis with Stan <img src="inst/logo/logo.png" align="right" width="120">
</h1></div>
<!-- badges: start -->

<p><a href="https://codecov.io/gh/davidissamattos/bpcs?branch=master"><img src="https://codecov.io/gh/davidissamattos/bpcs/branch/master/graph/badge.svg" alt="Codecov test coverage"></a> <!-- badges: end --></p>
<p>The <code>bpcs</code> package performs Bayesian estimation of Paired Comparison models utilizing Stan, such as variations of the Bradley-Terry (Bradley and Terry 1952) and the Davidson models (Davidson 1970).</p>
<p>Package documentation and vignette articles can be found at: <a href="https://davidissamattos.github.io/bpcs/" class="uri">https://davidissamattos.github.io/bpcs/</a></p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>For the <code>bpcs</code> package to work, we rely upon the Stan software and the <code>rstan</code> package (Stan Development Team 2020).</p>
<ul>
<li>For general installation of Stan and RStan see: <a href="https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started" class="uri">https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started</a>
</li>
<li>For macOS: <a href="https://github.com/stan-dev/rstan/wiki/Installing-RStan-from-source-on-a-Mac" class="uri">https://github.com/stan-dev/rstan/wiki/Installing-RStan-from-source-on-a-Mac</a>
</li>
<li>For Linux: <a href="https://github.com/stan-dev/rstan/wiki/Installing-RStan-on-Linux" class="uri">https://github.com/stan-dev/rstan/wiki/Installing-RStan-on-Linux</a>
</li>
<li>For Windows: <a href="https://github.com/stan-dev/rstan/wiki/Installing-RStan-from-source-on-Windows" class="uri">https://github.com/stan-dev/rstan/wiki/Installing-RStan-from-source-on-Windows</a>
</li>
</ul>
<p>At the moment we are not available in CRAN. To install the bpc package install directly from our Github repository</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op">(</span><span class="st">'davidissamattos/bpcs'</span><span class="op">)</span></pre></div>
<p>After install we load the package with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/davidissamattos/bpcs">bpcs</a></span><span class="op">)</span></pre></div>
</div>
<div id="minimal-example" class="section level2">
<h2 class="hasAnchor">
<a href="#minimal-example" class="anchor"></a>Minimal example</h2>
<p>The main function of the package is the <code>bpc</code> function. For the simple Bradley-Terry model, this function requires a specific type of data frame that contains:</p>
<ul>
<li>Two columns containing the name of the contestants in the paired comparison</li>
<li>Two columns containing the score of each player OR one column containing the result of the match (0 if player0 won, 1 if player1 won, 2 if it was a tie)</li>
</ul>
<p>We will utilize the tennis dataset available (Agresti 2003). The dataset can be seen below and is available as <code><a href="https://rdrr.io/r/utils/data.html">data(tennis_agresti)</a></code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="fu">sample_n</span><span class="op">(</span><span class="va">tennis_agresti</span>,<span class="fl">10</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span></pre></div>
<table class="table">
<thead><tr>
<th style="text-align:left;">
<p>player0</p>
</th>
<th style="text-align:left;">
<p>player1</p>
</th>
<th style="text-align:right;">
<p>y</p>
</th>
<th style="text-align:right;">
<p>id</p>
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
<p>Sabatini</p>
</td>
<td style="text-align:left;">
<p>Navratilova</p>
</td>
<td style="text-align:right;">
<p>1</p>
</td>
<td style="text-align:right;">
<p>37</p>
</td>
</tr>
<tr>
<td style="text-align:left;">
<p>Sabatini</p>
</td>
<td style="text-align:left;">
<p>Sanchez</p>
</td>
<td style="text-align:right;">
<p>1</p>
</td>
<td style="text-align:right;">
<p>41</p>
</td>
</tr>
<tr>
<td style="text-align:left;">
<p>Graf</p>
</td>
<td style="text-align:left;">
<p>Sanchez</p>
</td>
<td style="text-align:right;">
<p>0</p>
</td>
<td style="text-align:right;">
<p>30</p>
</td>
</tr>
<tr>
<td style="text-align:left;">
<p>Seles</p>
</td>
<td style="text-align:left;">
<p>Graf</p>
</td>
<td style="text-align:right;">
<p>1</p>
</td>
<td style="text-align:right;">
<p>5</p>
</td>
</tr>
<tr>
<td style="text-align:left;">
<p>Seles</p>
</td>
<td style="text-align:left;">
<p>Graf</p>
</td>
<td style="text-align:right;">
<p>0</p>
</td>
<td style="text-align:right;">
<p>1</p>
</td>
</tr>
<tr>
<td style="text-align:left;">
<p>Graf</p>
</td>
<td style="text-align:left;">
<p>Sanchez</p>
</td>
<td style="text-align:right;">
<p>0</p>
</td>
<td style="text-align:right;">
<p>29</p>
</td>
</tr>
<tr>
<td style="text-align:left;">
<p>Graf</p>
</td>
<td style="text-align:left;">
<p>Sabatini</p>
</td>
<td style="text-align:right;">
<p>0</p>
</td>
<td style="text-align:right;">
<p>20</p>
</td>
</tr>
<tr>
<td style="text-align:left;">
<p>Seles</p>
</td>
<td style="text-align:left;">
<p>Navratilova</p>
</td>
<td style="text-align:right;">
<p>1</p>
</td>
<td style="text-align:right;">
<p>10</p>
</td>
</tr>
<tr>
<td style="text-align:left;">
<p>Graf</p>
</td>
<td style="text-align:left;">
<p>Sabatini</p>
</td>
<td style="text-align:right;">
<p>0</p>
</td>
<td style="text-align:right;">
<p>15</p>
</td>
</tr>
<tr>
<td style="text-align:left;">
<p>Sabatini</p>
</td>
<td style="text-align:left;">
<p>Sanchez</p>
</td>
<td style="text-align:right;">
<p>0</p>
</td>
<td style="text-align:right;">
<p>38</p>
</td>
</tr>
</tbody>
</table>
<p>Based on the scores of each contestant, the <code>bpc</code> function computes automatically who won the contest. Alternatively, you can provide a vector of who won if that is already available (for more information see <code><a href="reference/bpc.html">?bpc</a></code>.</p>
<p>For the simple Bradley Terry Model we specify the model type as <code>'bt'</code>. Here we hide the MCMC sampler chain messages for simplicity in the output.</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="va">m</span><span class="op">&lt;-</span><span class="fu"><a href="reference/bpc.html">bpc</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">tennis_agresti</span>, <span class="co">#datafrane</span>
       player0 <span class="op">=</span> <span class="st">'player0'</span>, <span class="co">#name of the column for player 0</span>
       player1 <span class="op">=</span> <span class="st">'player1'</span>, <span class="co">#name of the column for player 1</span>
       result_column <span class="op">=</span> <span class="st">'y'</span>, <span class="co">#name of the column for the result of the match</span>
       model_type <span class="op">=</span> <span class="st">'bt'</span>, <span class="co">#bt = Simple Bradley Terry model</span>
       solve_ties <span class="op">=</span> <span class="st">'none'</span> <span class="co">#there are no ties in the dataset so we can choose none here</span>
       <span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; SAMPLING FOR MODEL 'bt' NOW (CHAIN 1).</span>
<span class="co">#&gt; Chain 1: </span>
<span class="co">#&gt; Chain 1: Gradient evaluation took 3.5e-05 seconds</span>
<span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.35 seconds.</span>
<span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span>
<span class="co">#&gt; Chain 1: </span>
<span class="co">#&gt; Chain 1: </span>
<span class="co">#&gt; Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span>
<span class="co">#&gt; Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span>
<span class="co">#&gt; Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span>
<span class="co">#&gt; Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span>
<span class="co">#&gt; Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span>
<span class="co">#&gt; Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)</span>
<span class="co">#&gt; Chain 1: </span>
<span class="co">#&gt; Chain 1:  Elapsed Time: 0.111683 seconds (Warm-up)</span>
<span class="co">#&gt; Chain 1:                0.087804 seconds (Sampling)</span>
<span class="co">#&gt; Chain 1:                0.199487 seconds (Total)</span>
<span class="co">#&gt; Chain 1: </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; SAMPLING FOR MODEL 'bt' NOW (CHAIN 2).</span>
<span class="co">#&gt; Chain 2: </span>
<span class="co">#&gt; Chain 2: Gradient evaluation took 2.6e-05 seconds</span>
<span class="co">#&gt; Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.26 seconds.</span>
<span class="co">#&gt; Chain 2: Adjust your expectations accordingly!</span>
<span class="co">#&gt; Chain 2: </span>
<span class="co">#&gt; Chain 2: </span>
<span class="co">#&gt; Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span>
<span class="co">#&gt; Chain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span>
<span class="co">#&gt; Chain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span>
<span class="co">#&gt; Chain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span>
<span class="co">#&gt; Chain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span>
<span class="co">#&gt; Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)</span>
<span class="co">#&gt; Chain 2: </span>
<span class="co">#&gt; Chain 2:  Elapsed Time: 0.095482 seconds (Warm-up)</span>
<span class="co">#&gt; Chain 2:                0.095356 seconds (Sampling)</span>
<span class="co">#&gt; Chain 2:                0.190838 seconds (Total)</span>
<span class="co">#&gt; Chain 2: </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; SAMPLING FOR MODEL 'bt' NOW (CHAIN 3).</span>
<span class="co">#&gt; Chain 3: </span>
<span class="co">#&gt; Chain 3: Gradient evaluation took 1.6e-05 seconds</span>
<span class="co">#&gt; Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.16 seconds.</span>
<span class="co">#&gt; Chain 3: Adjust your expectations accordingly!</span>
<span class="co">#&gt; Chain 3: </span>
<span class="co">#&gt; Chain 3: </span>
<span class="co">#&gt; Chain 3: Iteration:    1 / 2000 [  0%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration:  200 / 2000 [ 10%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration:  400 / 2000 [ 20%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration:  600 / 2000 [ 30%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration:  800 / 2000 [ 40%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span>
<span class="co">#&gt; Chain 3: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span>
<span class="co">#&gt; Chain 3: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span>
<span class="co">#&gt; Chain 3: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span>
<span class="co">#&gt; Chain 3: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span>
<span class="co">#&gt; Chain 3: Iteration: 2000 / 2000 [100%]  (Sampling)</span>
<span class="co">#&gt; Chain 3: </span>
<span class="co">#&gt; Chain 3:  Elapsed Time: 0.098423 seconds (Warm-up)</span>
<span class="co">#&gt; Chain 3:                0.098269 seconds (Sampling)</span>
<span class="co">#&gt; Chain 3:                0.196692 seconds (Total)</span>
<span class="co">#&gt; Chain 3: </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; SAMPLING FOR MODEL 'bt' NOW (CHAIN 4).</span>
<span class="co">#&gt; Chain 4: </span>
<span class="co">#&gt; Chain 4: Gradient evaluation took 1.6e-05 seconds</span>
<span class="co">#&gt; Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.16 seconds.</span>
<span class="co">#&gt; Chain 4: Adjust your expectations accordingly!</span>
<span class="co">#&gt; Chain 4: </span>
<span class="co">#&gt; Chain 4: </span>
<span class="co">#&gt; Chain 4: Iteration:    1 / 2000 [  0%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration:  200 / 2000 [ 10%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration:  400 / 2000 [ 20%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration:  600 / 2000 [ 30%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration:  800 / 2000 [ 40%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span>
<span class="co">#&gt; Chain 4: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span>
<span class="co">#&gt; Chain 4: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span>
<span class="co">#&gt; Chain 4: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span>
<span class="co">#&gt; Chain 4: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span>
<span class="co">#&gt; Chain 4: Iteration: 2000 / 2000 [100%]  (Sampling)</span>
<span class="co">#&gt; Chain 4: </span>
<span class="co">#&gt; Chain 4:  Elapsed Time: 0.110816 seconds (Warm-up)</span>
<span class="co">#&gt; Chain 4:                0.11118 seconds (Sampling)</span>
<span class="co">#&gt; Chain 4:                0.221996 seconds (Total)</span>
<span class="co">#&gt; Chain 4:</span></pre></div>
<p>If <code>rstan</code> is available and correctly working this function should sample the posterior distribution and create a <code>bpc</code> object.</p>
<p>To see a summary of the results we can run the summary function. Here we get three tables:</p>
<p>1- The parameters of the model 2- The probabilities of one player beating the other (this probability is based on the predictive posterior distribution) 3- The rank of the player based on their abilities (this rank is based on the predictive posterior ranks).</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span>
<span class="co">#&gt; Estimated baseline parameters with HPD intervals:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Parameter               Mean   HPD_lower   HPD_higher    n_eff   Rhat</span>
<span class="co">#&gt; --------------------  ------  ----------  -----------  -------  -----</span>
<span class="co">#&gt; lambda[Seles]           0.46       -2.33         3.16   751.34      1</span>
<span class="co">#&gt; lambda[Graf]            0.88       -2.02         3.35   745.14      1</span>
<span class="co">#&gt; lambda[Sabatini]       -0.39       -3.29         2.15   776.38      1</span>
<span class="co">#&gt; lambda[Navratilova]    -0.02       -2.78         2.66   747.83      1</span>
<span class="co">#&gt; lambda[Sanchez]        -1.18       -3.99         1.53   769.43      1</span>
<span class="co">#&gt; NOTES:</span>
<span class="co">#&gt; * A higher lambda indicates a higher team ability</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Posterior probabilities:</span>
<span class="co">#&gt; These probabilities are calculated from the predictive posterior distribution</span>
<span class="co">#&gt; for all player combinations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; i             j              i_beats_j</span>
<span class="co">#&gt; ------------  ------------  ----------</span>
<span class="co">#&gt; Graf          Navratilova         0.70</span>
<span class="co">#&gt; Graf          Sabatini            0.76</span>
<span class="co">#&gt; Graf          Sanchez             0.86</span>
<span class="co">#&gt; Graf          Seles               0.61</span>
<span class="co">#&gt; Navratilova   Sabatini            0.58</span>
<span class="co">#&gt; Navratilova   Sanchez             0.73</span>
<span class="co">#&gt; Navratilova   Seles               0.40</span>
<span class="co">#&gt; Sabatini      Sanchez             0.68</span>
<span class="co">#&gt; Sabatini      Seles               0.32</span>
<span class="co">#&gt; Sanchez       Seles               0.19</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Rank of the players' abilities:</span>
<span class="co">#&gt; The rank is based on the posterior rank distribution of the lambda parameter</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Parameter              MedianRank   MeanRank   StdRank</span>
<span class="co">#&gt; --------------------  -----------  ---------  --------</span>
<span class="co">#&gt; lambda[Graf]                    1       1.40      0.64</span>
<span class="co">#&gt; lambda[Seles]                   2       2.13      0.92</span>
<span class="co">#&gt; lambda[Navratilova]             3       3.02      0.89</span>
<span class="co">#&gt; lambda[Sabatini]                4       3.65      0.84</span>
<span class="co">#&gt; lambda[Sanchez]                 5       4.81      0.47</span></pre></div>
</div>
</div>
<div id="features-of-the-bpcs-package" class="section level1">
<h1 class="hasAnchor">
<a href="#features-of-the-bpcs-package" class="anchor"></a>Features of the bpcs package</h1>
<ul>
<li>Bayesian computation of different variations of the Bradley-Terry (including with home advantage, random effects and the generalized model).</li>
<li>Bayesian computation of different variations of the Davidson model to handle ties in the contest (including with home advantage, random effects and the generalized model).</li>
<li>Accepts a column with the results of the contest or the scores for each player.</li>
<li>Customize a normal prior distribution for every parameter.</li>
<li>Compute HDP interval for every parameter with the <code>get_hpdi_parameters</code> function</li>
<li>Compute rank of the players with the <code>get_rank_of_players</code> function.</li>
<li>Compute all the probability combinations for one player beating the other with the <code>get_probabilities</code> function.</li>
<li>Convert aggregated tables of results into long format (one contest per row) with the <code>expand_aggregated_data.</code>
</li>
<li>Obtain the posterior distribution for every parameter of the model with the <code>get_sample_posterior</code> function.</li>
<li>Easy predictions using the <code>predict</code> function.</li>
<li>We do not reinforce any table or plotting library! Results are returned as data frames for easier plotting and creating tables</li>
<li>We reinforce the need to manually specify the model to be used.</li>
</ul>
<div id="models-available" class="section level2">
<h2 class="hasAnchor">
<a href="#models-available" class="anchor"></a>Models available</h2>
<ul>
<li>Bradley-Terry (<code>bt</code>) (Bradley and Terry 1952)</li>
<li>Davidson model (<code>davidson</code>) for handling ties (Davidson 1970)</li>
<li>Bradley-Terry with order effect (<code>btordereffect</code>). E.g. for home advantage (Davidson and Beaver 1977)</li>
<li>Davidson model with order effect (<code>davidsonordereffect</code>). E.g. for home advantage with ties (Davidson and Beaver 1977)</li>
<li>Generalized Bradley-Terry model (<code>btgeneralized</code>). When we have contestant specific predictors TODO:add ref</li>
<li>Generalized Davidson model (<code>davidsongeneralized</code>). When we have contestant specific predictors and ties TODO:add ref</li>
<li>Bradley-Terry model with intercept random effects (<code>btU</code>). For example to compensate clustering or repeated measures TODO:add ref</li>
<li>Davidson model with intercept random effects (<code>davidsonU</code>). For example to compensate clustering or repeated measures when we have ties. TODO:add ref</li>
</ul>
<p>Note that we currently don’t variations and combinations of these models (e.g BT with order effect and random effect or generalized BT with order effect). Contact me if there is a need for one of these models and give me some examples so we can add to the vignettes!</p>
</div>
<div id="roadmap" class="section level2">
<h2 class="hasAnchor">
<a href="#roadmap" class="anchor"></a>Roadmap</h2>
<div id="goals-for-bpcs-100-before-chirstmas-2020" class="section level3">
<h3 class="hasAnchor">
<a href="#goals-for-bpcs-100-before-chirstmas-2020" class="anchor"></a>Goals for bpcs 1.0.0 (before Chirstmas 2020)</h3>
<ul>
<li>First official release</li>
<li>Working and tested models for <code>bt</code>, <code>btordereffect</code>, <code>btgeneralized</code>, <code>btU</code>, <code>davidson</code>, <code>davidsonordereffect</code>, <code>davidsongeneralized</code>, <code>davidsonU</code>
</li>
<li>Vignettes covering all/most models</li>
</ul>
</div>
<div id="goals-for-bpcs-110-before-june-2021" class="section level3">
<h3 class="hasAnchor">
<a href="#goals-for-bpcs-110-before-june-2021" class="anchor"></a>Goals for bpcs 1.1.0 (Before June 2021)</h3>
<ul>
<li>Reduce installation time by reducing number of stan models
<ul>
<li>The goal is to have fewer but more general stan models.</li>
<li>This will increase the complexity of the stan model but will reduce code for the predict, get_probabilities, and the bpc function</li>
</ul>
</li>
<li>Add new models for modeling time effects (newer contests have higher impact on the ability than older contests)</li>
<li>Add model for the Bayesian ELO-type rating system</li>
<li>Improve test coverage to 70%</li>
</ul>
</div>
</div>
</div>
<div id="vignettes" class="section level1">
<h1 class="hasAnchor">
<a href="#vignettes" class="anchor"></a>Vignettes</h1>
<p>This package provides a series of small and self contained vignettes that exemplify the use of each model. In the vignettes, we also provide examples of code for data transformation, tables and plots.</p>
<p>Below we list all our vignettes with a short description:</p>
<ul>
<li><p><a href="https://davidissamattos.github.io/bpcs/articles/a_get_started.html">Getting Started</a>: This vignette shows a basic example on tennis competition data, covering how to run a Bradley-Terry model, MCMC diagnostics, posterior predictive values, ranking, predict new matches</p></li>
<li><p><a href="https://davidissamattos.github.io/bpcs/articles/b_ties_and_home_advantage.html">Ties and home advantage</a>: This vignette covers a soccer example from the Brazilian soccer league. Here, we first model the results using a Bradley-Terry model and the Davidson model to handle ties. Then, we extend both models to include for order effects, this allows us to investigate the home advantage in and without the presence of ties.</p></li>
<li><p><a href="https://davidissamattos.github.io/bpcs/articles/c_bt_random_effects.html">Bradley-Terry with random effects</a>: This vignette covers the problem of ranking black-box optimization algorithms based on benchmarks. Since in benchmarking we often run the same optimization algorithm more than once with the same benchmark problem, we need to compensate for the repeated measures effect. We deal with this utilizing a simple Bradley-Terry model with random effects.</p></li>
</ul>
<p>*<a href="">Generalized Bradley-Terry model</a>: This vignette investigate the Bradley-Terry model when we have players specific characteristics. (TODO)</p>
</div>
<div id="contributing" class="section level1">
<h1 class="hasAnchor">
<a href="#contributing" class="anchor"></a>Contributing</h1>
<p>If you are interested you are welcome to contribute to the repository through pull requests.</p>
<p>If you have a strong need for a model that is not covered in this package (and do not want to code it yourself) send me an email or a suggestion in Github</p>
<div id="short-guidesuggestions" class="section level2">
<h2 class="hasAnchor">
<a href="#short-guidesuggestions" class="anchor"></a>Short guide/suggestions</h2>
<p>The points below are mostly reminders for me but hopefully it can help others</p>
<ul>
<li>Use the <code>devtools</code> package to create R files, test files, vignettes etc</li>
<li>In the R folder:
<ul>
<li>
<code>bpc.R</code>: this contains a single function (rather large) that is the main function call of the package. Each new model should be added here in the if else section with the appropriated data list for stan. Don’t forget to add the relevant documentation in roxygen2</li>
<li>
<code>bpc_exports.R</code>: these are helper functions to handle the <code>bpc</code> object and are exposed to the user. Only add here functions that receive a bpc object and that the users will have an interest.</li>
<li>
<code>bpc_get_probabilities.R</code> Since this is a big export function we have moved it to its own file</li>
<li>
<code>bpc_helpers_X.R</code> additional functions to facilitate and support either the bpc function or the exports functions. None of these functions should be exported, although all of them should be documented. We divided these helpers in several files. the indexes are related to creating and checking names and indexes in lookup tables, the hpd to HPDI related functions, the checks to check correct specification of the data frame columns</li>
<li>
<code>bpc_s3.R</code> all functions here are the custom implementation of the generic base functions from R, such as <code>summary</code>, <code>print</code>, <code>predict</code>
</li>
<li>
<code>data-docs.R</code> documentation for the data.</li>
<li>
<code>bpc_object.R</code> declaration and creation of the bpc class.</li>
</ul>
</li>
<li>To add new models:
<ol>
<li>Add the stan file with the model in inst/stan. <!-- end list -->
</li>
</ol>
<ul>
<li>Note that we add two stan files for each model, one that will estimate the parameters and one that will make predictions <!-- end list -->
</li>
</ul>
<ol>
<li>add the appropriated hooks in the <code>bpc</code> function in <code>bpc.R</code> so we can call the model</li>
<li>add the appropriated hooks in the <code>predict</code> function in <code>bpc_s3.R</code>.</li>
<li>add the appropriated hooks for the <code>get_probabilities</code> function in <code>bpc_get_probabilities.R</code> to generate the appropriated probability table that is called in the <code>summary</code> function.</li>
<li>add the relevant tests to each of the modifications (to be improved with time, since we have very few tests now)</li>
</ol>
</li>
<li>Problems with <code>rstantools</code> and compiling the models. For me at least, the combination of <code>RStudio</code>+ <code>rstantools</code> + <code>roxygen2</code> + <code>devtools</code> + <code>Rcpp</code>+ <code>devtools</code> gives an assorted amount of stochastic errors can usually be solved with a combination of the actions below. For me it is still trial and error to fix the error but it usually works with these actions:
<ul>
<li>Restart the r session and try <code><a href="https://devtools.r-lib.org//reference/load_all.html">devtools::load_all()</a></code> again</li>
<li>After adding a model try <code><a href="https://devtools.r-lib.org//reference/document.html">devtools::document()</a></code>
</li>
<li>If deleting a model file delete the appropriated line in stanmodels.R and do document again</li>
<li>If the model is not recompiling or updating do <code><a href="https://rdrr.io/pkg/pkgbuild/man/clean_dll.html">pkgbuild::clean_dll()</a></code> then <code><a href="https://devtools.r-lib.org//reference/document.html">devtools::document()</a></code> and possibly <code><a href="https://devtools.r-lib.org//reference/load_all.html">devtools::load_all()</a></code> or <code><a href="https://devtools.r-lib.org//reference/install.html">devtools::install()</a></code>
</li>
</ul>
</li>
</ul>
<p>There are some dev-functions in inst/devfunctions to help building the package website and running test coverage (and submitting to codecov).</p>
</div>
</div>
<div id="icon-credits" class="section level1">
<h1 class="hasAnchor">
<a href="#icon-credits" class="anchor"></a>Icon credits</h1>
<ul>
<li>Boxing gloves image by “surang” from “flaticons.com”</li>
<li>Hex Sticker created with the <a href="https://github.com/GuangchuangYu/hexSticker">hexSticker</a> package</li>
</ul>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-agresti2003categorical">
<p>Agresti, Alan. 2003. <em>Categorical Data Analysis</em>. Vol. 482. John Wiley &amp; Sons.</p>
</div>
<div id="ref-bradley1952rank">
<p>Bradley, Ralph Allan, and Milton E Terry. 1952. “Rank Analysis of Incomplete Block Designs: I. The Method of Paired Comparisons.” <em>Biometrika</em> 39 (3/4): 324–45.</p>
</div>
<div id="ref-davidson1970extending">
<p>Davidson, Roger R. 1970. “On Extending the Bradley-Terry Model to Accommodate Ties in Paired Comparison Experiments.” <em>Journal of the American Statistical Association</em> 65 (329): 317–28.</p>
</div>
<div id="ref-davidson1977extending">
<p>Davidson, Roger R, and Robert J Beaver. 1977. “On Extending the Bradley-Terry Model to Incorporate Within-Pair Order Effects.” <em>Biometrics</em>, 693–702.</p>
</div>
<div id="ref-rstan">
<p>Stan Development Team. 2020. “RStan: The R Interface to Stan.” <a href="http://mc-stan.org/" class="uri">http://mc-stan.org/</a>.</p>
</div>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/davidissamattos/bpcs/">https://​github.com/​davidissamattos/​bpcs/​</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="citation">
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing bpcs</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>David Issa Mattos <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-2501-9926" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://cran.r-project.org/web/licenses/MIT"><img src="https://img.shields.io/badge/license-MIT-yellow.svg" alt="License: MIT"></a></li>
<li><a href="https://github.com/davidissamattos/bpcs/commits/master"><img src="https://img.shields.io/github/last-commit/davidissamattos/bpcs.svg"></a></li>
<li><a href="https://www.tidyverse.org/lifecycle/#experimental"><img src="https://img.shields.io/badge/lifecycle-experimental-blue.svg"></a></li>
<li><a href="https://github.com/davidissamattos/bpcs"><img src="https://img.shields.io/github/languages/code-size/davidissamattos/bpcs.svg"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by David Issa Mattos.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
